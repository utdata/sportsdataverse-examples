{"title":"FBRef team stats","markdown":{"yaml":{"title":"FBRef team stats"},"headingText":"Install the packages","containsRefs":false,"markdown":"\n\nExploring the [worldfootballR](https://jaseziv.github.io/worldfootballR/index.html) package where you can get soccer stats from FBref.com and more.\n\nHere we are trying to get goals by team for a season, which are in the standard season ending team stats.\n\n\nIf you don't already have the devtools and worldfootballR packages, uncomment the code below to install them. HOWEVER, recomment after you've done so. You only have to install the packages ONE TIME.\n\n```{r}\n# install.packages(\"devtools\")\n# devtools::install_github(\"JaseZiv/worldfootballR\")\n```\n\n\n## Setup\n\n```{r}\n#| label: setup\n#| message: false\n#| warning: false\n\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(worldfootballR)\n```\n\n\n## Basic use\n\nAn attempt to learn how to do certain things.\n\nThis gets the URL for specific leagues and years.\n\nThe function is described here: [fb_league_urls()](https://jaseziv.github.io/worldfootballR/reference/fb_league_urls.html)\n\n```{r}\nfb_league_urls(country = \"ENG\", gender = \"M\", season_end_year = 2021, tier = '1st')\n```\n\nWhich then lets you get team urls:\n\nThis function is described here. [fb_teams_urls()](https://jaseziv.github.io/worldfootballR/reference/fb_teams_urls.html)\n\n```{r}\nfb_teams_urls(\"https://fbref.com/en/comps/9/Premier-League-Stats\")\n```\n\n## Looking for goals\n\nA goal for a student was to find how many goal teams scored throughout seasons to see if there are generally more.\n\n### Big 5 Leagues\n\nExploring functions that will get goals by team each season.\n\nThis gets \"standard\" team stats from all big 5 European leagues using [fb_big5_advanced_season_stats()](https://jaseziv.github.io/worldfootballR/reference/fb_big5_advanced_season_stats.html)\n\n```{r}\nbig5_stand_21 <- fb_big5_advanced_season_stats(\n  season_end_year=2021,\n  stat_type=\"standard\",\n  team_or_player=\"team\",\n  time_pause = 3) |>\n  clean_names()\n\nbig5_stand_21 |> glimpse()\n\nbig5_stand_21 |> write_rds(\"data-raw/fbref-team-stats/big5_stand_2021.rds\")\n```\n\nMy suggestion would be to save the above table as a .rds file to a computer so you don't have to hit the website everytime you work with it.\n\nThat big5 could then then be filtered to a specific league.\n\n```{r}\nbig5_stand_21 |> filter(comp == \"Premier League\") |> filter(team_or_opponent == \"team\")\n\n```\n\n#### Functionalize this\n\nThere idea is I could take what is above and turn it into a function and swap out the years.\n\n```{r}\n# you could update the start, end year here\n# I would not do more than maybe 5 years at a time\nyrs <- 2020:2022\n\nscrape_big5 <- function(yr) {\n  fb_big5_advanced_season_stats(\n  season_end_year=yr,\n  stat_type=\"standard\",\n  team_or_player=\"team\",\n  time_pause = 3) |>\n  clean_names()\n}\n\nfor (i in yrs) {\n  big5_stand <- scrape_big5(i)\n  big5_stand |> write_rds(paste0(\"data-raw/fbref-team-stats/big5_stand_\", i, \".rds\"))\n}\n```\n\n\n### Specific league\n\nThis is same as big_5 but for specific leagues. Here we get Premier League. using [fb_season_team_stats()](https://jaseziv.github.io/worldfootballR/reference/fb_season_team_stats.html).\n\n```{r}\nfb_season_team_stats(\"ENG\", \"M\", 2021, \"1st\", \"standard\", time_pause = 3)\n```\n\nAgain, this could be turned into a function and sent through a range of years if you just wanted one league. Just like the one above.\n\n### Goal logs\n\nInteresting information about goals. This function is described here: [fb_team_goal_logs()](https://jaseziv.github.io/worldfootballR/reference/fb_team_goal_logs.html). What I don't know is how to get different years.\n\n```{r}\nteam_urls <- c(\"https://fbref.com/en/squads/b8fd03ef/Manchester-City-Stats\", \"https://fbref.com/en/squads/822bd0ba/Liverpool-Stats\")\n\nfb_team_goal_logs(team_urls = team_urls, for_or_against = \"for\", time_pause = 3)\n```\n","srcMarkdownNoYaml":"\n\nExploring the [worldfootballR](https://jaseziv.github.io/worldfootballR/index.html) package where you can get soccer stats from FBref.com and more.\n\nHere we are trying to get goals by team for a season, which are in the standard season ending team stats.\n\n## Install the packages\n\nIf you don't already have the devtools and worldfootballR packages, uncomment the code below to install them. HOWEVER, recomment after you've done so. You only have to install the packages ONE TIME.\n\n```{r}\n# install.packages(\"devtools\")\n# devtools::install_github(\"JaseZiv/worldfootballR\")\n```\n\n\n## Setup\n\n```{r}\n#| label: setup\n#| message: false\n#| warning: false\n\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(worldfootballR)\n```\n\n\n## Basic use\n\nAn attempt to learn how to do certain things.\n\nThis gets the URL for specific leagues and years.\n\nThe function is described here: [fb_league_urls()](https://jaseziv.github.io/worldfootballR/reference/fb_league_urls.html)\n\n```{r}\nfb_league_urls(country = \"ENG\", gender = \"M\", season_end_year = 2021, tier = '1st')\n```\n\nWhich then lets you get team urls:\n\nThis function is described here. [fb_teams_urls()](https://jaseziv.github.io/worldfootballR/reference/fb_teams_urls.html)\n\n```{r}\nfb_teams_urls(\"https://fbref.com/en/comps/9/Premier-League-Stats\")\n```\n\n## Looking for goals\n\nA goal for a student was to find how many goal teams scored throughout seasons to see if there are generally more.\n\n### Big 5 Leagues\n\nExploring functions that will get goals by team each season.\n\nThis gets \"standard\" team stats from all big 5 European leagues using [fb_big5_advanced_season_stats()](https://jaseziv.github.io/worldfootballR/reference/fb_big5_advanced_season_stats.html)\n\n```{r}\nbig5_stand_21 <- fb_big5_advanced_season_stats(\n  season_end_year=2021,\n  stat_type=\"standard\",\n  team_or_player=\"team\",\n  time_pause = 3) |>\n  clean_names()\n\nbig5_stand_21 |> glimpse()\n\nbig5_stand_21 |> write_rds(\"data-raw/fbref-team-stats/big5_stand_2021.rds\")\n```\n\nMy suggestion would be to save the above table as a .rds file to a computer so you don't have to hit the website everytime you work with it.\n\nThat big5 could then then be filtered to a specific league.\n\n```{r}\nbig5_stand_21 |> filter(comp == \"Premier League\") |> filter(team_or_opponent == \"team\")\n\n```\n\n#### Functionalize this\n\nThere idea is I could take what is above and turn it into a function and swap out the years.\n\n```{r}\n# you could update the start, end year here\n# I would not do more than maybe 5 years at a time\nyrs <- 2020:2022\n\nscrape_big5 <- function(yr) {\n  fb_big5_advanced_season_stats(\n  season_end_year=yr,\n  stat_type=\"standard\",\n  team_or_player=\"team\",\n  time_pause = 3) |>\n  clean_names()\n}\n\nfor (i in yrs) {\n  big5_stand <- scrape_big5(i)\n  big5_stand |> write_rds(paste0(\"data-raw/fbref-team-stats/big5_stand_\", i, \".rds\"))\n}\n```\n\n\n### Specific league\n\nThis is same as big_5 but for specific leagues. Here we get Premier League. using [fb_season_team_stats()](https://jaseziv.github.io/worldfootballR/reference/fb_season_team_stats.html).\n\n```{r}\nfb_season_team_stats(\"ENG\", \"M\", 2021, \"1st\", \"standard\", time_pause = 3)\n```\n\nAgain, this could be turned into a function and sent through a range of years if you just wanted one league. Just like the one above.\n\n### Goal logs\n\nInteresting information about goals. This function is described here: [fb_team_goal_logs()](https://jaseziv.github.io/worldfootballR/reference/fb_team_goal_logs.html). What I don't know is how to get different years.\n\n```{r}\nteam_urls <- c(\"https://fbref.com/en/squads/b8fd03ef/Manchester-City-Stats\", \"https://fbref.com/en/squads/822bd0ba/Liverpool-Stats\")\n\nfb_team_goal_logs(team_urls = team_urls, for_or_against = \"for\", time_pause = 3)\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"worldfootballr-fbref-teamstats.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.39","theme":"cosmo","title":"FBRef team stats"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}